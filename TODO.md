# ReceiptQR - 残タスク一覧

最終更新: 2026年1月4日

---

## 🔴 緊急・必須（App Store申請前）

### ドキュメント
- [x] プライバシーポリシー作成（日本語・英語）
- [x] 利用規約作成（日本語・英語）
- [x] サブスクリプション法的表示作成
- [x] App Store申請用ドキュメント（テキスト形式）
- [ ] App Store用スクリーンショット準備
- [ ] App Storeアプリ説明文作成

### 機能実装
- [x] サブスクリプション機能（RevenueCat）
- [x] 3日間無料トライアル
- [x] StoreKit Configuration（ローカルテスト）
- [x] 法的文書表示画面（Markdown）
- [x] QRコードPDF URL埋め込み
- [x] チュートリアル画面実装
- [x] チュートリアル初回起動時強制表示
- [x] 設定画面からチュートリアル再表示
- [x] Firebase Storage Rules修正（PDF 403エラー対応）

### App Store設定
- [ ] プライバシーポリシーURL設定
- [ ] カスタムEULA（利用規約）設定
- [ ] アプリアイコン最終確認
- [ ] スクリーンショット（必須サイズ準備）
- [ ] テストアカウント情報準備
- [ ] ビルド番号インクリメント
- [ ] リリースノート作成（日本語・英語）

---

## 🟡 優先度高（次回アップデート）

### メール送信機能
- [ ] SendGridアカウント作成
- [ ] SendGrid API Key取得
- [ ] Single Sender Verification設定
- [ ] Firebase Extension「Trigger Email from Firestore」インストール
- [ ] Extension SMTP設定
- [ ] HTMLメールテンプレート作成
- [ ] テスト送信実行

**実装済み**:
- [x] メール送信キュー追加機能（ReceiptRepository）
- [x] 設定画面でメール送信ON/OFF切り替え

**詳細**: `SENDGRID_SETUP.md` 参照

### ユーザー向けコンテンツ
- [ ] アプリ説明文作成（日本語・英語）
  - [ ] 短い説明文（80文字）
  - [ ] 詳細説明文（4000文字）
  - [ ] キーワード選定
- [ ] FAQ作成
  - [ ] よくある質問リストアップ
  - [ ] 回答作成（Markdown）
  - [ ] FAQ表示画面実装
  - [ ] 設定画面からリンク追加
- [ ] エラーメッセージ改善
  - [ ] 既存エラーメッセージ洗い出し
  - [ ] わかりやすい日本語に書き換え
  - [ ] 対処方法を含める
  - [ ] constants.dartに集約

---

## 🟢 優先度中

### アナリティクス・モニタリング
- [ ] Firebase Analytics設定確認
- [ ] 主要イベント定義
  - [ ] 領収書作成イベント
  - [ ] PDF生成イベント
  - [ ] サブスクリプション購入イベント
  - [ ] ログイン/ログアウトイベント
- [ ] イベントログ実装
- [ ] Google Analytics連携（オプション）

### クラッシュレポート
- [ ] Firebase Crashlytics確認（SDK追加済みか）
- [ ] iOS/Android設定
- [ ] テストクラッシュ実行
- [ ] ダッシュボード確認
- [ ] エラー通知設定

---

## 🔵 優先度低（将来実装）

### 機能拡張
- [ ] 領収書デザインカスタマイズ機能
  - [ ] テンプレート選択
  - [ ] 色・フォント変更
  - [ ] ロゴ位置調整
- [ ] 領収書一括エクスポート
  - [ ] 期間指定
  - [ ] ZIP圧縮
  - [ ] ダウンロード機能
- [ ] ダークモード対応
  - [ ] ダークテーマ作成
  - [ ] 全画面対応
  - [ ] システム設定連動
- [ ] 多言語対応（英語）
  - [ ] UI文字列の外部化
  - [ ] arb/l10nファイル作成
  - [ ] 言語切り替え機能

### 運用改善
- [ ] オンボーディング改善
- [ ] プッシュ通知（領収書作成完了）
- [ ] データバックアップ機能
- [ ] CSVエクスポート機能
- [ ] 月次レポート機能

---

## 🛠️ 技術的改善

### コード品質
- [ ] Riverpod 2.0完全移行確認
- [ ] テストコード追加
  - [ ] Unit Test（Repository, Service）
  - [ ] Widget Test（主要画面）
  - [ ] Integration Test（E2E）
- [ ] Linter設定見直し
- [ ] コードカバレッジ測定

### パフォーマンス
- [ ] 画像圧縮処理最適化
- [ ] PDF生成速度改善
- [ ] Firestore読み込み最適化
  - [ ] キャッシュ活用
  - [ ] インデックス最適化
- [ ] アプリサイズ削減

### CI/CD
- [ ] GitHub Actions設定
  - [ ] ビルド自動化
  - [ ] テスト自動実行
  - [ ] Linter自動実行
- [ ] Firebase App Distribution連携
- [ ] TestFlight自動アップロード

---

## ⚙️ インフラ・運用

### Firebase
- [ ] Firestore Security Rules最終確認
- [ ] Storage Rules最終確認
- [ ] Firebase Blaze Plan移行（Functions使用のため）
- [ ] バックアップ設定
- [ ] モニタリング・アラート設定

### DNS・ドメイン
- [ ] DNSネームサーバー反映待ち
- [ ] SendGrid Domain Authentication設定（DNS反映後）
- [ ] カスタムドメインメール設定

### セキュリティ
- [ ] .envファイル管理方法確認
- [ ] API Key管理方法確認
- [ ] セキュリティ監査実施

---

## 📋 ドキュメント

### 開発者向け
- [x] NEXT_UPDATE.md（次回アップデート予定）
- [x] SENDGRID_SETUP.md（SendGrid設定ガイド）
- [x] TODO.md（このファイル）
- [ ] README.md更新
  - [ ] アプリ概要
  - [ ] セットアップ手順
  - [ ] ビルド方法
  - [ ] 環境変数設定
- [ ] CONTRIBUTING.md作成
- [ ] CHANGELOG.md作成

### ユーザー向け
- [x] プライバシーポリシー（Markdown + テキスト）
- [x] 利用規約（Markdown + テキスト）
- [x] サブスクリプション規約（Markdown + テキスト）
- [ ] ユーザーガイド
- [ ] FAQ
- [ ] トラブルシューティングガイド

---

## 🐛 既知の問題

現在、既知の問題はありません。

---

## ✅ 最近完了したタスク

### 2026年1月4日
- [x] サブスクリプション機能実装完了
  - RevenueCat統合
  - 3日間無料トライアル
  - 月額/年額プラン
  - StoreKit Configuration（ローカルテスト）
- [x] 法的文書作成・表示実装
  - プライバシーポリシー（日本語・英語）
  - 利用規約（日本語・英語）
  - サブスクリプション規約（日本語・英語）
  - Markdown表示画面
  - App Store申請用テキスト版
- [x] QRコード改善
  - データからPDF URLへ変更
  - 2段階PDF生成方式実装
  - PDF内QRコード表示追加
- [x] プロジェクトドキュメント整備
  - NEXT_UPDATE.md作成
  - SENDGRID_SETUP.md作成
  - TODO.md作成

---

## 📝 メモ

### App Store申請について
- プライバシーポリシーと利用規約は必須
- スクリーンショットは各デバイスサイズで必要
- テストアカウント情報必須（サブスクリプションがあるため）
- 審査は通常1-3日（初回は長め）

### SendGridについて
- DNSネームサーバー反映待ち
- 現在はSingle Sender Verificationで対応可能（5分で完了）
- Domain Authenticationは反映後に実施推奨

### 次回アップデート優先順位
1. メール送信機能（SendGrid設定）
2. アプリ説明文・FAQ作成
3. Analytics/Crashlytics設定
4. エラーメッセージ改善

---

最終更新: 2026年1月4日
